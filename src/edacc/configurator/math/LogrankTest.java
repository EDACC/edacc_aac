package edacc.configurator.math;

import org.rosuda.JRI.Rengine;
import org.rosuda.JRI.REXP;

/**
 * Logrank (aka Mantel-Cox test) 2-sample test.
 * 
 * @author daniel
 * 
 */
public class LogrankTest {
    private Rengine rengine;

    public LogrankTest(Rengine rengine) {
        this.rengine = rengine;
    }

    public double pValue(double[] x, double[] y, boolean[] x_censored, boolean[] y_censored) {
        if (x.length != y.length) {
            throw new IllegalArgumentException("x and y have to be of the same length.");
        }
        double[] combinedData = new double[x.length + y.length];
        int[] group = new int[x.length + y.length];
        int[] combinedCensored = new int[x.length + y.length];

        for (int i = 0; i < x.length; i++) {
            combinedData[i] = x[i];
            combinedData[x.length + i] = y[i];
            group[i] = 1;
            group[x.length + i] = 2;
            combinedCensored[i] = x_censored[i] ? 0 : 1;
            combinedCensored[x.length + i] = y_censored[i] ? 0 : 1;
        }

        rengine.assign("combinedData", combinedData);
        rengine.assign("group", group);
        rengine.assign("combinedCensored", combinedCensored);
        REXP res = rengine.eval("1 - pchisq(survdiff(Surv(combinedData, combinedCensored) ~ group)$chisq, 1)");
        
        if (res == null) return 1.0;
        return res.asDouble();
    }
    
    public static void main(String ... args) throws Exception {
        Rengine rengine = new Rengine(new String[] { "--vanilla" }, false, null);

        if (!rengine.waitForR()) {
            throw new Exception("Could not initialize Rengine");
        }

        if (rengine.eval("library(asbio)") == null) {
            rengine.end();
            throw new Exception("Did not find R library asbio (try running install.packages(\"asbio\")).");
        }

        if (rengine.eval("library(survival)") == null) {
            rengine.end();
            throw new Exception("Did not find R library survival (should come with R though).");
        }
     
        
        double[][] data = new double[][] {
                { 14.0529, 8.0258, 20.0000, 10.8883, 14.3998, 11.1753, 7.2069 },
                { 1.4008, 1.5558, 1.1308, 2.2377, 1.2768, 1.0938, 2.3126 },
                { 15.8646, 18.3512, 6.4770, 20.0000, 9.9655, 20.0000, 20.0000 },
                { 1.0398, 1.7137, 0.7949, 1.3318, 1.3318, 1.0298, 1.4838 },
                { 1.9127, 2.2607, 1.9077, 1.7307, 4.6773, 1.4038, 3.4375 },
                { 9.4316, 11.9912, 8.8107, 7.3149, 20.0000, 8.0458, 20.0000 },
                { 12.6331, 15.0207, 20.0000, 20.0000, 20.0000, 11.2303, 19.4190 },
                { 1.1388, 1.7977, 0.9569, 1.2418, 1.1178, 1.5078, 1.2428 },
                { 15.8016, 17.3934, 9.6395, 12.2351, 20.0000, 9.1326, 20.0000 },
                { 9.1556, 3.1325, 1.5868, 2.1987, 6.3770, 2.9146, 2.3066 },
                { 1.9547, 5.1412, 3.9104, 12.1032, 2.5736, 10.7674, 13.4570 },
                { 6.4070, 20.0000, 20.0000, 10.0855, 20.0000, 20.0000, 3.5455 },
                { 10.4014, 20.0000, 15.6766, 1.7007, 3.1285, 8.5117, 3.9964 },
                { 10.0285, 20.0000, 19.4210, 20.0000, 7.2679, 20.0000, 20.0000 },
                { 5.7621, 16.7405, 6.6680, 8.2897, 20.0000, 14.4808, 20.0000 },
                { 20.0000, 20.0000, 20.0000, 19.0861, 20.0000, 20.0000, 20.0000 },
                { 3.5505, 7.0599, 20.0000, 7.6828, 6.2590, 11.1943, 8.5777 },
                { 1.1618, 4.6773, 2.3026, 1.8307, 1.6068, 2.0537, 7.1909 },
                { 20.0000, 20.0000, 10.6974, 20.0000, 20.0000, 8.4577, 20.0000 },
                { 1.3038, 1.1288, 1.3948, 1.1028, 1.3658, 1.2698, 1.7067 },
                { 0.9559, 2.5216, 2.1167, 1.2298, 1.3978, 1.6118, 3.2875 },
                { 1.4028, 1.5798, 1.4258, 1.2098, 1.9967, 1.9397, 2.8256 },
                { 1.2088, 2.6576, 2.4266, 2.1977, 1.5238, 1.4468, 1.9147 },
                { 20.0000, 4.8933, 12.4071, 14.9957, 4.1104, 20.0000, 15.2097 },
                { 20.0000, 20.0000, 20.0000, 7.3139, 9.7025, 20.0000, 20.0000 },
                { 1.2858, 1.1758, 1.1708, 2.4716, 2.4596, 1.0098, 1.7727 },
                { 20.0000, 19.6310, 2.6486, 2.1917, 1.7577, 3.4505, 10.4444 },
                { 11.0043, 6.1131, 6.2551, 3.0635, 7.9498, 3.1955, 2.3117 },
                { 10.4674, 4.7643, 17.6623, 18.2392, 4.6273, 17.9523, 7.0259 },
                { 4.7913, 20.0000, 12.3921, 0.8669, 20.0000, 3.2145, 5.8711 },
                { 1.4078, 1.8937, 1.5828, 1.1828, 2.1117, 1.6257, 1.5978 },
                { 2.9725, 1.4808, 3.8574, 4.1474, 3.3825, 2.0807, 0.8419 },
                { 1.7027, 3.0105, 2.0847, 1.9637, 2.2107, 2.8366, 2.3456 },
                { 9.7045, 20.0000, 20.0000, 6.9369, 20.0000, 13.4040, 9.1536 },
                { 6.3550, 7.0189, 12.9030, 15.3917, 15.4916, 13.0390, 6.3120 },
                { 5.9171, 8.2347, 4.1694, 7.9068, 4.9152, 5.2232, 2.8656 },
                { 2.4186, 1.4408, 1.3528, 1.5418, 2.1297, 1.0019, 1.1938 },
                { 1.1878, 0.6789, 2.0787, 1.9477, 1.0418, 0.8369, 1.7497 },
                { 9.8935, 20.0000, 6.7430, 3.7164, 20.0000, 20.0000, 20.0000 },
                { 4.2184, 4.2424, 1.7697, 3.3445, 3.0665, 2.1267, 4.5943 },
                { 20.0000, 20.0000, 20.0000, 20.0000, 20.0000, 20.0000, 20.0000 },
                { 1.1768, 1.0638, 1.5708, 1.9337, 1.6817, 1.6178, 1.4558 },
                { 20.0000, 20.0000, 6.0181, 5.0912, 6.1781, 2.8046, 20.0000 },
                { 20.0000, 20.0000, 20.0000, 20.0000, 20.0000, 20.0000, 8.9326 },
                { 20.0000, 8.8097, 20.0000, 13.3490, 20.0000, 20.0000, 3.2145 },
                { 4.7593, 3.9204, 4.3543, 3.4185, 1.8867, 2.5276, 11.9452 },
                { 5.1002, 3.6894, 5.1972, 12.8710, 16.0846, 9.2376, 14.3768 },
                { 2.5536, 1.7607, 1.7147, 2.0717, 1.7067, 1.0998, 1.7397 },
                { 2.2197, 1.7777, 2.8636, 2.0727, 1.6707, 0.8269, 3.6305 },
                { 2.3277, 1.1468, 1.4088, 2.5436, 1.6827, 1.0368, 2.0817 },
                { 0.7539, 2.3446, 1.1778, 1.4048, 1.3608, 1.4828, 1.2278 },
                { 1.4478, 2.1097, 1.2128, 2.2317, 2.3087, 2.0797, 2.9265 },
                { 6.5480, 11.1323, 3.7594, 7.0929, 4.9402, 4.0764, 3.9884 },
                { 2.4706, 5.5771, 3.9194, 3.7624, 3.9884, 1.8407, 4.1544 },
                { 2.9895, 20.0000, 20.0000, 20.0000, 20.0000, 11.0893, 20.0000 },
                { 2.4246, 2.4986, 1.7407, 1.2368, 1.3558, 1.4488, 1.2708 },
                { 1.3778, 3.2305, 9.7795, 1.4078, 3.8304, 2.1787, 8.3497 },
                { 20.0000, 20.0000, 20.0000, 20.0000, 20.0000, 20.0000, 20.0000 },
                { 0.7099, 1.8727, 1.0238, 1.6478, 1.1308, 1.3588, 1.0608 },
                { 6.1531, 10.4914, 12.7971, 6.5880, 15.7676, 4.6953, 2.2627 },
                { 1.0938, 2.5646, 1.0868, 1.9207, 1.0808, 1.2908, 2.3716 },
                { 20.0000, 18.6142, 20.0000, 20.0000, 8.0108, 20.0000, 20.0000 },
                { 2.2836, 1.3838, 3.6504, 5.6941, 2.0377, 2.1217, 3.7834 },
                { 20.0000, 20.0000, 20.0000, 8.9246, 20.0000, 20.0000, 20.0000 },
                { 0.7479, 1.2288, 1.3328, 1.3938, 1.2448, 1.0108, 1.3698 },
                { 13.0740, 4.5573, 20.0000, 20.0000, 9.9355, 7.5708, 20.0000 },
                { 5.9151, 6.2540, 2.8456, 1.6678, 3.6114, 2.4476, 10.3204 },
                { 3.4405, 4.9623, 3.0225, 4.3573, 9.0516, 3.1375, 12.5341 },
                { 1.7827, 1.7567, 0.8089, 1.5108, 1.6108, 1.6827, 1.2818 },
                { 20.0000, 14.5188, 9.5435, 20.0000, 20.0000, 20.0000, 20.0000 },
                { 7.9648, 7.7218, 3.2305, 1.4468, 7.3379, 9.6225, 1.7167 },
                { 1.4048, 1.6547, 1.7097, 1.4838, 0.9749, 1.0108, 0.9709 },
                { 2.7786, 7.4729, 3.3655, 5.3632, 1.7427, 6.2491, 3.6195 },
                { 1.3798, 1.8627, 2.2237, 2.4186, 2.2227, 2.5356, 2.5396 },
                { 20.0000, 20.0000, 17.1224, 20.0000, 20.0000, 20.0000, 20.0000 },
                { 3.2275, 1.9237, 1.4558, 1.2858, 2.8396, 1.5058, 1.1048 },
                { 0.9649, 1.3308, 1.5268, 1.1248, 1.4188, 1.4838, 2.0607 },
                { 1.6128, 1.4068, 1.4358, 1.6617, 0.6669, 0.9169, 1.9047 },
                { 2.2577, 1.4298, 1.4548, 1.5768, 0.7499, 0.8519, 1.4578 },
                { 2.9436, 1.9597, 2.6716, 2.4376, 3.0895, 2.8586, 2.9376 },
                { 2.8276, 1.3168, 1.6437, 1.5168, 1.6107, 0.9928, 1.5788 },
                { 8.7477, 3.9904, 20.0000, 20.0000, 20.0000, 20.0000, 8.4957 },
                { 1.6008, 1.8277, 2.2027, 1.5278, 1.7387, 1.7167, 3.2075 },
                { 20.0000, 20.0000, 13.6699, 7.7588, 9.7535, 20.0000, 19.5340 },
                { 1.6157, 2.3476, 1.2008, 1.4308, 2.5516, 1.1968, 3.5905 },
                { 0.7309, 1.7017, 2.1677, 2.9235, 1.5548, 1.0698, 2.2517 },
                { 20.0000, 20.0000, 20.0000, 20.0000, 20.0000, 20.0000, 20.0000 },
                { 20.0000, 3.0295, 2.3356, 3.9274, 2.9555, 6.9019, 3.3515 },
                { 20.0000, 20.0000, 20.0000, 20.0000, 20.0000, 20.0000, 20.0000 },
                { 2.8156, 1.7627, 1.0548, 1.3918, 2.6046, 0.9669, 0.9269 },
                { 1.7287, 1.6677, 1.5818, 1.1808, 1.7057, 2.3066, 1.1408 },
                { 2.1117, 4.3713, 4.6193, 4.4893, 4.6463, 5.9851, 6.6660 },
                { 1.6248, 0.9898, 1.1198, 1.4158, 0.9519, 1.0698, 1.2568 },
                { 2.7226, 2.2597, 1.6747, 1.6547, 3.0415, 1.3008, 2.4456 },
                { 1.0938, 2.1637, 1.4408, 2.1457, 1.9047, 1.4918, 3.1115 },
                { 1.6058, 2.2467, 1.8377, 2.0357, 6.2580, 1.2728, 3.7214 },
                { 1.7117, 1.0518, 1.6747, 3.3815, 1.5178, 1.8767, 3.5285 },
                { 2.1767, 2.5356, 2.5976, 1.6847, 3.0345, 1.6437, 2.4766 },
                { 8.7447, 8.8267, 7.9028, 3.8884, 6.1661, 3.3035, 8.3377 },
                { 1.9657, 2.1087, 2.0777, 3.3045, 3.1115, 1.1328, 4.6713 },
                { 17.3464, 7.6068, 6.8980, 9.2456, 4.4203, 20.0000, 8.1088 },
                { 1.8787, 2.6196, 2.3816, 2.4506, 4.3943, 3.0245, 2.7446 },
                { 16.7664, 10.2494, 20.0000, 15.5076, 7.8068, 20.0000, 20.0000 },
                { 2.0287, 3.1285, 1.1848, 2.3147, 2.0577, 1.3368, 1.1898 },
                { 8.5387, 5.1032, 20.0000, 3.1565, 11.0903, 8.7787, 8.3417 },
                { 5.7341, 2.0257, 5.5951, 3.1655, 3.2065, 5.5922, 2.6806 },
                { 20.0000, 20.0000, 20.0000, 20.0000, 20.0000, 14.2828, 20.0000 },
                { 1.5248, 1.6537, 1.9067, 1.9567, 2.8046, 4.7273, 5.6851 },
                { 1.5158, 1.5078, 1.9347, 1.6907, 1.6207, 2.1487, 1.6707 },
                { 1.8747, 1.0598, 2.7676, 2.0257, 1.5298, 1.8757, 1.2698 },
                { 20.0000, 20.0000, 20.0000, 20.0000, 4.3783, 20.0000, 20.0000 },
                { 20.0000, 20.0000, 20.0000, 20.0000, 20.0000, 20.0000, 20.0000 },
                { 1.0748, 2.3066, 1.3568, 2.3806, 1.8417, 2.2947, 2.6696 },
                { 2.0517, 1.0008, 1.4128, 1.0868, 0.7609, 1.6437, 1.7127 },
                { 3.0295, 3.4195, 6.1171, 4.6953, 8.2478, 7.6588, 4.2773 },
                { 13.0180, 8.6997, 7.5238, 6.7610, 20.0000, 7.6538, 4.1634 },
                { 1.7117, 1.9917, 0.9199, 2.9365, 2.6766, 3.3675, 2.2877 },
                { 2.1757, 2.0777, 1.6897, 1.4308, 2.1167, 1.6987, 2.0997 },
                { 20.0000, 9.6965, 20.0000, 20.0000, 9.4786, 2.1067, 3.2995 },
                { 1.0698, 1.2278, 1.0858, 1.4348, 1.1018, 1.4138, 1.2348 },
                { 20.0000, 20.0000, 20.0000, 20.0000, 20.0000, 20.0000, 20.0000 },
                { 20.0000, 20.0000, 11.6602, 20.0000, 10.7064, 5.5272, 20.0000 },
                { 20.0000, 10.1805, 10.8164, 4.6453, 7.7588, 7.0779, 20.0000 },
                { 1.5378, 1.4048, 1.5008, 1.9897, 1.4888, 0.5139, 1.4378 },
                { 3.0445, 3.7294, 7.3339, 2.0207, 7.0659, 2.4786, 2.7046 },
                { 4.2214, 17.7983, 4.2533, 20.0000, 20.0000, 2.5186, 20.0000 },
                { 18.9361, 13.9329, 6.4180, 20.0000, 20.0000, 20.0000, 20.0000 },
                { 2.0927, 1.1658, 0.9159, 1.3628, 0.9469, 1.1668, 1.5858 },
                { 1.8067, 1.6737, 2.5316, 4.3423, 2.5086, 2.5306, 5.5932 },
                { 1.3058, 1.7247, 3.2085, 2.4526, 1.7267, 1.2278, 3.1695 },
                { 20.0000, 6.3110, 16.8194, 20.0000, 20.0000, 20.0000, 20.0000 },
                { 20.0000, 20.0000, 20.0000, 20.0000, 20.0000, 17.8953, 8.7847 },
                { 1.5698, 1.4638, 1.2938, 1.6467, 1.0378, 0.8049, 1.9097 },
                { 13.6589, 16.8714, 20.0000, 15.4057, 4.3333, 1.4088, 20.0000 },
                { 1.9547, 0.8789, 0.9539, 2.6716, 1.5758, 1.1978, 3.2775 },
                { 20.0000, 20.0000, 20.0000, 20.0000, 20.0000, 20.0000, 20.0000 },
                { 6.3220, 6.2171, 3.5505, 7.1639, 5.2182, 3.5975, 13.6299 },
                { 8.2967, 20.0000, 16.5455, 12.8290, 6.4930, 14.2398, 20.0000 },
                { 2.3136, 1.9827, 1.1478, 1.1708, 1.1728, 1.3168, 3.4045 },
                { 3.1225, 4.7783, 5.2112, 2.6226, 2.4666, 2.1277, 3.9904 },
                { 3.3875, 4.0824, 2.9335, 4.3383, 1.2078, 2.4996, 5.1202 },
                { 12.7881, 5.0902, 20.0000, 20.0000, 18.5692, 3.5295, 20.0000 },
                { 1.9677, 1.0908, 1.2468, 2.3616, 2.9695, 0.9299, 2.6376 },
                { 0.8459, 1.4258, 1.1098, 1.0378, 1.5348, 1.0388, 1.6398 },
                { 4.5793, 1.5918, 1.1448, 4.1074, 1.9647, 2.8866, 2.1887 },
                { 15.9306, 12.8930, 20.0000, 7.7558, 7.0589, 3.5465, 3.3765 },
                { 2.2847, 1.5108, 0.9958, 1.0818, 1.7517, 0.6699, 2.9565 },
                { 13.8709, 14.7238, 6.1051, 8.0448, 10.2074, 20.0000, 4.0964 },
                { 5.0632, 20.0000, 20.0000, 20.0000, 20.0000, 20.0000, 5.6291 },
                { 2.1957, 1.1188, 1.4118, 1.3778, 1.7637, 1.3168, 1.4388 },
                { 1.3938, 0.8799, 0.9329, 1.8127, 1.3158, 0.9629, 1.8197 },
                { 1.4358, 1.6267, 1.8367, 2.1177, 1.4768, 1.8747, 3.8934 },
                { 3.7204, 4.6803, 3.2945, 2.5336, 3.6225, 4.2684, 8.3287 },
                { 20.0000, 1.9637, 20.0000, 20.0000, 20.0000, 20.0000, 20.0000 },
                { 1.0658, 1.4698, 1.0508, 2.0877, 0.8209, 1.5568, 2.0597 },
                { 1.7447, 2.0377, 2.7456, 5.6501, 6.1711, 4.8873, 15.5416 },
                { 1.7087, 1.4548, 1.0928, 1.5388, 1.1768, 1.2898, 1.4158 },
                { 16.0576, 9.6615, 17.2824, 4.5653, 20.0000, 13.1090, 20.0000 },
                { 2.7066, 2.9416, 1.8457, 2.4606, 1.9197, 1.8757, 1.6328 },
                { 10.4774, 20.0000, 20.0000, 11.4913, 20.0000, 5.3292, 20.0000 },
                { 20.0000, 20.0000, 20.0000, 20.0000, 20.0000, 20.0000, 20.0000 },
                { 18.9921, 20.0000, 20.0000, 20.0000, 5.9261, 17.3664, 5.2362 },
                { 1.5038, 2.9195, 1.3058, 1.5388, 1.2388, 1.4818, 1.4808 },
                { 6.1831, 7.3529, 20.0000, 5.4602, 8.1078, 19.2341, 20.0000 },
                { 20.0000, 20.0000, 20.0000, 20.0000, 20.0000, 20.0000, 20.0000 },
                { 2.9406, 2.1297, 3.5375, 12.2701, 9.5445, 6.9159, 7.3149 },
                { 6.0381, 13.8519, 8.3327, 4.3893, 6.3580, 17.2284, 20.0000 },
                { 7.3449, 8.8696, 3.9174, 9.4786, 5.0622, 17.7433, 4.6273 },
                { 1.3918, 1.4488, 1.9117, 1.0098, 2.7306, 1.4218, 2.5146 },
                { 1.2158, 0.8869, 0.8909, 0.7329, 1.0478, 1.4048, 3.7764 },
                { 1.7847, 0.8209, 1.6467, 2.0687, 1.3618, 2.2477, 2.3456 },
                { 3.5465, 19.9400, 4.8793, 8.4787, 3.5635, 5.4322, 11.5292 },
                { 1.3768, 2.2477, 1.7167, 2.7306, 2.9176, 2.7046, 1.4018 },
                { 20.0000, 20.0000, 9.2576, 18.0723, 6.8590, 14.4058, 12.1781 },
                { 5.7381, 8.2997, 2.7206, 3.4015, 2.0837, 5.1032, 9.9435 },
                { 1.9217, 1.9237, 19.0141, 20.0000, 12.6951, 9.7905, 3.1995 },
                { 1.5078, 1.1958, 1.5228, 1.9367, 1.3468, 1.3908, 1.6987 },
                { 2.2627, 1.5858, 1.4048, 1.2888, 2.0547, 1.5598, 2.6626 },
                { 1.6228, 1.2798, 1.0748, 1.3798, 0.9838, 0.9609, 1.8647 },
                { 2.2917, 1.1308, 1.8927, 1.3318, 1.4558, 2.0207, 3.4305 },
                { 3.4445, 2.9425, 3.3735, 2.6806, 1.8157, 3.0865, 2.4256 },
                { 20.0000, 10.1775, 6.8170, 3.2605, 11.1023, 3.5824, 20.0000 },
                { 1.6228, 1.3758, 1.7377, 1.5428, 4.0664, 3.9844, 2.4876 },
                { 20.0000, 7.7558, 19.7780, 20.0000, 20.0000, 20.0000, 20.0000 },
                { 2.6016, 2.4246, 5.9531, 3.5235, 2.6146, 2.0527, 3.9834 },
                { 2.5886, 2.7986, 2.9815, 2.5496, 1.4638, 1.8437, 2.3556 },
                { 1.9437, 3.8864, 2.9235, 3.1975, 2.6156, 3.3635, 5.1012 },
                { 20.0000, 15.5036, 6.5330, 20.0000, 16.7005, 20.0000, 7.9838 },
                { 6.0621, 14.0509, 6.8210, 6.6340, 5.8791, 3.3365, 5.3992 },
                { 1.7017, 2.8156, 1.5438, 2.5186, 1.7727, 1.3638, 2.0477 },
                { 20.0000, 20.0000, 20.0000, 20.0000, 20.0000, 20.0000, 20.0000 },
                { 1.1328, 1.7967, 1.0178, 2.6086, 1.2478, 2.3586, 1.9697 },
                { 2.0347, 1.7027, 1.9947, 1.2408, 3.4685, 1.9467, 3.2605 },
                { 1.7277, 1.2738, 1.0108, 1.2978, 0.9219, 1.6217, 2.5346 },
                { 1.4008, 1.3878, 0.8429, 1.7037, 1.1368, 0.8699, 2.5276 },
                { 3.8334, 1.8587, 2.6836, 2.9555, 1.9497, 2.5576, 2.0627 },
                { 1.5318, 1.9017, 2.2777, 2.2926, 1.9277, 1.6528, 2.5696 },
                { 20.0000, 2.4106, 3.9244, 20.0000, 9.8405, 11.2343, 20.0000 },
                { 3.3835, 9.0486, 5.2392, 9.9515, 10.3584, 20.0000, 12.5261 },
                { 4.8433, 6.4720, 4.8343, 3.7444, 1.5168, 3.6435, 8.0138 },
                { 20.0000, 20.0000, 20.0000, 15.6016, 20.0000, 3.1755, 20.0000 },
                { 15.2907, 20.0000, 17.9923, 20.0000, 20.0000, 20.0000, 20.0000 },
                { 13.0370, 20.0000, 12.0822, 7.6768, 2.9885, 20.0000, 4.7563 },
                { 20.0000, 9.3076, 20.0000, 20.0000, 20.0000, 10.2554, 9.5176 },
                { 1.7097, 1.1588, 1.5868, 2.2826, 1.2538, 1.3658, 1.9227 },
                { 13.9969, 20.0000, 20.0000, 15.2467, 20.0000, 5.0152, 9.5105 },
                { 20.0000, 20.0000, 20.0000, 20.0000, 12.7291, 20.0000, 20.0000 },
                { 2.3966, 2.3266, 1.2358, 1.1628, 1.5648, 1.5238, 1.4478 },
                { 5.0952, 2.5976, 2.7656, 1.7747, 2.4176, 3.5105, 5.1982 },
                { 3.9844, 3.5824, 1.0808, 1.1348, 3.6254, 1.2758, 2.6726 },
                { 3.9324, 7.4639, 6.4160, 6.8910, 2.0667, 6.7440, 2.9985 },
                { 2.4886, 1.8657, 2.5456, 2.2957, 2.9595, 1.8157, 3.2045 },
                { 2.7876, 1.5848, 1.3968, 2.5066, 1.9687, 2.2117, 1.2668 },
                { 20.0000, 13.9009, 20.0000, 11.6962, 19.1891, 8.6047, 20.0000 },
                { 1.3538, 1.6018, 1.3748, 1.4598, 2.2527, 1.9887, 1.4968 },
                { 0.9958, 3.0995, 2.4706, 2.3096, 2.3036, 1.5848, 2.7586 },
                { 20.0000, 20.0000, 15.6506, 11.9992, 20.0000, 7.2699, 20.0000 },
                { 1.0188, 1.4628, 1.2358, 1.4788, 0.8899, 1.3258, 1.0328 },
                { 1.2828, 1.3148, 1.0618, 1.0738, 0.9039, 1.2448, 1.6558 },
                { 1.7177, 2.7586, 1.4288, 1.5728, 1.5438, 1.5148, 3.6305 },
                { 1.4728, 1.1698, 1.1258, 0.8789, 1.9277, 0.7679, 1.3548 },
                { 2.3296, 1.6378, 1.7917, 1.6727, 1.1768, 1.0498, 1.5578 },
                { 1.8457, 1.5788, 0.9199, 1.7427, 2.8726, 2.0497, 1.8787 },
                { 1.4688, 0.7549, 1.4278, 1.5658, 1.8207, 1.1028, 1.9467 },
                { 2.9985, 2.7516, 6.5300, 2.9695, 3.3325, 3.0495, 8.9846 },
                { 2.1177, 1.7437, 1.5758, 2.0027, 1.9987, 1.3188, 1.1598 },
                { 20.0000, 20.0000, 20.0000, 20.0000, 20.0000, 20.0000, 20.0000 },
                { 1.7247, 2.1647, 1.1538, 2.0487, 2.1097, 2.0697, 1.6887 },
                { 1.6447, 0.9189, 1.1308, 1.7697, 1.0388, 1.2948, 1.3968 },
                { 1.3688, 2.2037, 1.6867, 1.8817, 1.1768, 1.4938, 3.7674 },
                { 20.0000, 20.0000, 20.0000, 20.0000, 20.0000, 20.0000, 20.0000 },
                { 20.0000, 20.0000, 20.0000, 20.0000, 20.0000, 11.3523, 20.0000 },
                { 20.0000, 19.5090, 20.0000, 18.5732, 20.0000, 10.1675, 3.9774 },
                { 1.6707, 2.5106, 1.9027, 1.0148, 1.7217, 1.3148, 1.1698 },
                { 5.2352, 2.7926, 6.1031, 2.2297, 4.2923, 3.9424, 8.4697 },
                { 2.1087, 6.8460, 8.4517, 10.5644, 9.0566, 11.8922, 6.3350 },
                { 3.8344, 1.3258, 3.4355, 8.6507, 7.5778, 10.1605, 3.8704 },
                { 0.9069, 1.2608, 0.9679, 1.5088, 0.8779, 1.0388, 2.0957 },
                { 2.2977, 3.0655, 4.1704, 2.9425, 4.8533, 2.3356, 3.9404 },
                { 2.2187, 4.1304, 1.9567, 6.7330, 2.2966, 3.0925, 5.0312 },
                { 10.7394, 20.0000, 8.2807, 9.4995, 12.3261, 12.5321, 14.9697 },
                { 7.7648, 7.3379, 4.3513, 6.9789, 18.6812, 20.0000, 16.5695 },
                { 2.5346, 1.4758, 1.7967, 1.6747, 1.5808, 1.3578, 3.0885 },
                { 7.2349, 15.6576, 2.7076, 20.0000, 13.3520, 16.0516, 20.0000 },
                { 5.1842, 3.4995, 3.1355, 3.2845, 8.9436, 4.5673, 4.3793 },
                { 7.9288, 6.0541, 15.5576, 2.0407, 7.6948, 2.0117, 9.1496 },
                { 1.9767, 1.8417, 2.0837, 1.4078, 3.0445, 1.1188, 1.8307 },
                { 2.0777, 2.1447, 1.8077, 2.3516, 2.1057, 2.3366, 1.7947 },
                { 1.6178, 2.2687, 3.0365, 2.5706, 1.8487, 1.7987, 5.9201 },
                { 12.7741, 3.4205, 3.1255, 6.6450, 5.1682, 1.9377, 6.4220 },
                { 1.8687, 1.2388, 0.9858, 1.1848, 1.8017, 0.6799, 0.9579 },
                { 19.4230, 7.4069, 8.2218, 16.2945, 6.9819, 7.7038, 20.0000 },
                { 3.3845, 2.8316, 2.7936, 5.0282, 1.3348, 2.6326, 2.8306 },
                { 14.7008, 2.4036, 8.1658, 8.5887, 1.7167, 2.9316, 1.9757 },
                { 2.5296, 2.6706, 3.8314, 7.3719, 6.0051, 5.1982, 3.6804 },
                { 20.0000, 20.0000, 20.0000, 20.0000, 20.0000, 20.0000, 20.0000 },
                { 1.3798, 1.8607, 2.2637, 1.5508, 1.2658, 1.6977, 2.8766 },
                { 20.0000, 7.8638, 11.2183, 11.8832, 9.1646, 20.0000, 16.1095 },
                { 2.6686, 7.0349, 1.0308, 8.2797, 11.1753, 1.7447, 4.1294 },
                { 2.5496, 2.2187, 0.7319, 1.2648, 0.9519, 1.1288, 0.7229 },
                { 1.4338, 1.1098, 1.4618, 1.1258, 1.6617, 1.2488, 2.2417 },
                { 1.3028, 1.4068, 2.8736, 3.4555, 1.8217, 1.8657, 3.7484 },
                { 1.2678, 1.3458, 1.8167, 2.1467, 3.3415, 2.1527, 5.7381 },
                { 5.8941, 2.7526, 4.2894, 4.8023, 5.7781, 9.5775, 2.9546 },
                { 5.1632, 3.6744, 2.6096, 5.9061, 3.5555, 2.4076, 3.5345 },
                { 7.0199, 20.0000, 20.0000, 20.0000, 7.7118, 20.0000, 20.0000 },
                { 12.7441, 20.0000, 16.0676, 20.0000, 20.0000, 20.0000, 9.0376 },
                { 20.0000, 20.0000, 14.4268, 20.0000, 5.7771, 20.0000, 20.0000 },
                { 2.6556, 2.5146, 1.6997, 1.8337, 1.7377, 1.7097, 3.5215 },
                { 20.0000, 20.0000, 20.0000, 20.0000, 20.0000, 20.0000, 20.0000 },
                { 2.1597, 1.6937, 1.6187, 2.1207, 2.2527, 1.9597, 3.7644 },
                { 9.2226, 2.3966, 3.2285, 18.5242, 4.3833, 3.4345, 16.2585 },
                { 20.0000, 20.0000, 20.0000, 5.1332, 20.0000, 10.3284, 14.5038 },
                { 2.8586, 1.8777, 2.9225, 2.5986, 3.6594, 3.1185, 4.8033 },
                { 1.2968, 1.7017, 1.4108, 1.2438, 1.4388, 1.2608, 1.4088 },
                { 16.7804, 20.0000, 20.0000, 20.0000, 20.0000, 20.0000, 20.0000 },
                { 4.3783, 1.3668, 8.4037, 3.9314, 5.1112, 4.8033, 12.7721 },
                { 2.3056, 1.7387, 2.4766, 2.1527, 1.3368, 1.5918, 2.1897 },
                { 1.6078, 1.2138, 1.4578, 1.7017, 1.5828, 1.3258, 2.2187 },
                { 2.0167, 1.9707, 1.9467, 5.0972, 3.4825, 3.6095, 3.2965 },
                { 9.6065, 20.0000, 20.0000, 20.0000, 20.0000, 20.0000, 20.0000 },
                { 1.5008, 1.2348, 1.0978, 1.5898, 1.4108, 0.9549, 1.2538 },
                { 1.5718, 1.6817, 1.5088, 1.4628, 2.1817, 2.5466, 2.5676 },
                { 1.3068, 1.2978, 1.2758, 1.6178, 1.2938, 1.0008, 1.7177 },
                { 20.0000, 20.0000, 20.0000, 20.0000, 13.9369, 20.0000, 16.9454 },
                { 2.0477, 1.2618, 1.1028, 1.5168, 1.4078, 1.6358, 1.9377 },
                { 3.1445, 20.0000, 6.1851, 20.0000, 5.0092, 9.4836, 6.8899 },
                { 1.5098, 1.3048, 0.9669, 1.1998, 1.1458, 1.7297, 2.5716 },
                { 1.4218, 1.4858, 1.1158, 1.3668, 2.5066, 1.6508, 0.9988 },
                { 2.5686, 7.9978, 16.8474, 20.0000, 19.1601, 18.8121, 20.0000 },
                { 1.5468, 2.0747, 1.5658, 1.9897, 1.7647, 1.3558, 3.6165 },
                { 2.2297, 2.1597, 1.8427, 2.6856, 3.2585, 2.4356, 2.8996 },
                { 2.0087, 2.5386, 1.9837, 4.2453, 2.6376, 3.6484, 3.3355 },
                { 1.5238, 1.3568, 1.0468, 0.8859, 1.1578, 0.7779, 1.7617 },
                { 1.9997, 7.0459, 4.2084, 2.6446, 4.0854, 3.9604, 3.1095 },
                { 20.0000, 4.4923, 20.0000, 8.6137, 9.4936, 15.6186, 2.8186 },
                { 12.7611, 20.0000, 10.6934, 20.0000, 20.0000, 20.0000, 20.0619 },
                { 3.0515, 1.6398, 1.3168, 1.8637, 0.8339, 1.1908, 1.8807 },
                { 2.7766, 2.0857, 1.7477, 3.2095, 1.9597, 2.1497, 6.7390 },
                { 1.3618, 1.4468, 1.4068, 1.2948, 0.9958, 1.5238, 1.3268 },
                { 1.9337, 1.4078, 2.1597, 2.1437, 2.4026, 2.1017, 2.1257 },
                { 2.4236, 1.9017, 1.7917, 2.2826, 1.4318, 3.1365, 2.9495 },
                { 1.1818, 1.2158, 1.6647, 1.1408, 1.5558, 0.9609, 2.0097 },
                { 8.8267, 2.0877, 2.2577, 4.9802, 7.7298, 6.0831, 2.5966 },
                { 2.2457, 3.1835, 4.0524, 3.6474, 2.0967, 2.4926, 6.9159 },
                { 3.1815, 2.4476, 2.6576, 2.4476, 0.8019, 3.6405, 4.5683 },
                { 1.6337, 4.0984, 2.0297, 2.3596, 1.6777, 4.3643, 3.4895 },
                { 7.9638, 7.8448, 20.0000, 2.6136, 9.7805, 6.3250, 17.3574 },
                { 1.1848, 1.8407, 1.2018, 1.0288, 1.1918, 1.4728, 1.5238 },
                { 5.8561, 20.0000, 13.3930, 5.4142, 2.8936, 6.4800, 20.0000 },
                { 7.3739, 8.0798, 4.1214, 15.7546, 3.6664, 4.6353, 4.7213 },
                { 1.5838, 2.2926, 1.7767, 2.4406, 1.4898, 4.5263, 5.8441 },
                { 20.0000, 17.8733, 20.0000, 20.0000, 20.0000, 18.9511, 7.0989 },
                { 2.9666, 1.3818, 2.3926, 1.8517, 2.3746, 2.5706, 1.1868 },
                { 20.0000, 20.0000, 20.0000, 20.0000, 20.0000, 18.5562, 4.7513 },
                { 1.4928, 1.4658, 1.1138, 0.9749, 0.9039, 1.7767, 2.5306 },
                { 1.6887, 1.6337, 0.8739, 1.6358, 1.4678, 1.6038, 2.1017 },
                { 1.1918, 1.1408, 0.8999, 1.2408, 0.7229, 1.2008, 1.5128 },
                { 1.0158, 2.0967, 1.9767, 1.5208, 1.6817, 1.7347, 1.4748 },
                { 20.0000, 15.3827, 5.6801, 20.0000, 12.8500, 7.3559, 20.0000 },
                { 1.3968, 1.0328, 0.6459, 1.0538, 2.1547, 1.5018, 0.9898 },
                { 1.0738, 1.1398, 1.0828, 0.8789, 1.2898, 0.8689, 1.4338 },
                { 20.0000, 20.0000, 15.5986, 20.0000, 14.7388, 9.3986, 20.0000 },
                { 1.4238, 1.1808, 0.6859, 0.9659, 1.3718, 1.8507, 1.9097 },
                { 6.5840, 17.3674, 7.9198, 7.6748, 14.4118, 9.5255, 3.4915 },
                { 4.5673, 4.5933, 4.5523, 3.5345, 3.0215, 5.1802, 11.6562 },
                { 6.1991, 4.8763, 5.4122, 4.9583, 5.2482, 5.8881, 6.3050 },
                { 1.2558, 1.3788, 1.0488, 1.4148, 1.5408, 1.3838, 1.3178 },
                { 3.3265, 2.0717, 2.1877, 1.7367, 1.9127, 1.6137, 1.8097 },
                { 20.0000, 15.7456, 20.0000, 20.0000, 20.0000, 20.0000, 20.0000 },
        };
        
        for (int i = 0; i < data[0].length; i++) {
            double sum = 0.0;
            for (int j = 0; j < data.length; j++) {
                sum += data[j][i];
            }
            System.out.println(sum / data.length);
        }
        
        double[] x = new double[data.length];
        double[] y = new double[data.length];
        boolean[] xc = new boolean[data.length];
        boolean[] yc = new boolean[data.length];
        
        for (int i = 0; i < data.length; i++) {
            x[i] = data[i][5];
            y[i] = data[i][6];
            xc[i] = x[i] >= 20;
            yc[i] = y[i] >= 20;
        }
        
        LogrankTest lr = new LogrankTest(rengine);
        System.out.println("p: " + lr.pValue(x, y, xc, yc));

        rengine.end();
    }
    
    
}
